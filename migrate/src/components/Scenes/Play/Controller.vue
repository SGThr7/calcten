<script lang="ts">
import { h, VNodeArrayChildren, defineComponent } from 'vue'
import { Brackets, Operators } from '@/modules/operator'
import Key from '@/components/UI/Buttons/Key.vue'

export default defineComponent({
	name: 'Controller',
	props: {
		addOperator: {
			type: Function,
			required: true,
		},
		removeOperator: {
			type: Function,
			required: true,
		},
		allowAddOperator: {
			type: Function,
			default: () => true,
		},
	},
	render() {
		const children: VNodeArrayChildren = []
		for (const bracket of Brackets)
			children.push(
				h(
					Key,
					{
						onClick: () => this.addOperator(bracket.toString()),
						disabled: !this.allowAddOperator(bracket.toString()),
					},
					() => bracket.toString()
				)
			)
		children.push(
			h(
				Key,
				{
					onClick: () => this.removeOperator(),
					class: 'remove-key',
					disabled: !this.allowAddOperator(),
				},
				() => '←'
			)
		)
		for (const operator of Operators)
			children.push(
				h(
					Key,
					{
						onClick: () => this.addOperator(operator.toString()),
						disabled: !this.allowAddOperator(operator.toString()),
					},
					() => operator.toString()
				)
			)
		return h('div', { class: 'controller' }, children)
	},
})
</script>

<style lang="sass" scoped>
$col-count: 4

.controller
	width: 100%

	display: grid
	grid-template-columns: repeat($col-count, 1fr)
	gap: 10px

	.remove-key
		grid-column: $col-count

// square grid
.controller
	grid-auto-rows: 1fr

	&::before
		content: ' '
		width: 0
		grid-row: 1 / 1
		grid-column: 1 / 1
		padding-bottom: 100%

	& > *:first-child
		grid-row: 1 / 1
		grid-column: 1 / 1
</style>
